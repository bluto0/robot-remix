<!-- I was lost as to how I should direct my attention for my second project. i scrapped many dif ideas before remembering jake's stuff and exploring his Youtube. I decided to learn a bit more about HTML/CSS and more about how to code an arpeggio with his tutorial and add my own spin-->
<!-- the following HTML & CSS is guided by Jake's tutorial-- the "types", "alt", "name", and "label" details was pretty new to me -->
<header>
  <input id="chord-1" value="1" type="radio" name="chord" />
  <input id="chord-2" value="2" type="radio" name="chord" />
  <input id="chord-3" value="3" type="radio" name="chord" />
  <input id="chord-4" value="4" type="radio" name="chord" />
  <input id="chord-5" value="5" type="radio" name="chord" />
  <ul>
    <li><label for="chord-1"><img src="ghost.jpg" alt="Chord 1"></label></li>
    <li><label for="chord-2"><img src="bulb.jpg" alt="Chord 2"></label></li>
    <li><label for="chord-3"><img src="skelly.jpg" alt="Chord 3"></label></li>
    <li><label for="chord-4"><img src="dino.jpg" alt="Chord 4"></label></li>
    <li><label for="chord-5"><img src="lava.jpg" alt="Chord 5"></label></li>
  </ul>
</header>

<style>
  html,
  body {
    height: 100%;
    background: black;
  }

  header {
    position: relative;
    overflow: hidden;
    height: 100%;
  }

  ul {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  li {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: black;
    margin: 0 10px;
    transition: transform 0.5s;
  }

  input {
    position: absolute;
    left: -9999px;
  }

  img {
    width: 90px;
    height: 90px;
    pointer-events: none;
  }

  @for $i from 1 through 5 {
    &#chord-#{$i}:checked~ul li:nth-child(#{$i}) {
      transform: rotate(calc((#{$i} - 1) * 72deg)) translate(-50%, -50%) translateY(-150px) rotate(calc((1 - #{$i}) * 72deg));
    }
  }
</style>


<script src="https://tonejs.github.io/build/Tone.js"></script>

<script>
  const buttons = document.querySelectorAll('li');
  const numButtons = buttons.length;
  const radius = 300;
  const centerX = window.innerWidth / 2;
  const centerY = window.innerHeight / 2;

  buttons.forEach((button, index) => {
    const angle = (index / numButtons) * 2 * Math.PI;
    const x = centerX + radius * Math.cos(angle) - button.offsetWidth / 2;
    const y = centerY + radius * Math.sin(angle) - button.offsetHeight / 2;
    button.style.left = `${x}px`;
    button.style.top = `${y}px`;
  });
</script>


<script>
  console.clear();

  // UPDATE: there is a problem in chrome with starting audio context
  //  before a user gesture. This fixes it.
  var started = false;
  document.documentElement.addEventListener('mousedown', () => {
    if (started) return;
    started = true;

    const $inputs = document.querySelectorAll('input'),
      chords = [
        'A4 C#5 E6', 'F1 A2 C3', 'G3 B3 D3',
        'D2 F2 A2', 'E2 G2 B2'
      ].map(formatChords);
    console.log(chords);
    var chordIdx = 0,
      step = 0;

    const synth = new Tone.Synth();
    const gain = new Tone.Gain(0.7);
    synth.oscillator.type = 'sine';
    gain.toMaster();
    synth.connect(gain);

    Array.from($inputs).forEach($input => {
      $input.addEventListener('change', () => {
        if ($input.checked) handleChord($input.value);
      })
    });

    function handleChord(valueString) {
      chordIdx = parseInt(valueString) - 1;
    }

    Tone.Transport.scheduleRepeat(onRepeat, '16n');
    Tone.Transport.start();
    Tone.Transport.bpm.value = 90;

    function onRepeat(time) {
      let chord = chords[chordIdx],
        note = chord[step % chord.length];
      synth.triggerAttackRelease(note, '16n', time);
      step++;
    }

    function formatChords(chordString) {
      return chordString.split(' ');
    }
  });
</script>